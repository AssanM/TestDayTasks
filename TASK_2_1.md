Мы работаем с [тайловой картой](https://github.com/s-prozorov/TestDayTasks/blob/main/TASK_1_1.md), состоящей из нескольких слоёв, где каждый слой отвечает за отдельный аспект мира.  
На предыдущих этапах реализованы слои **поверхности**, **объектов** и **регионов (стран)**.  

На текущем этапе необходимо спроектировать и реализовать **сетевой слой**, который будет предоставлять клиентам доступ к данным карты через UDP, используя библиотеку **LiteNetLib**.  
Сериализация сообщений должна выполняться через **MesagePack**, чтобы обеспечить максимальную производительность и минимальные накладные расходы.  

---

## Необходимый функционал
- **Запрос объектов в области.** Клиент может отправить координатный запрос, сервер возвращает все объекты, находящиеся в указанной области.  
- **Запрос регионов в области.** Аналогично, клиент запрашивает прямоугольную область, сервер возвращает список регионов (страны), которые пересекают её.  
- **Уведомления клиентов.** Сервер должен рассылать сообщения клиентам при добавлении, изменении или удалении объектов карты.  

---

## Свойства и контракты
- **Запросы:**
  - `GetObjectsInAreaRequest`: прямоугольная область `(x1,y1,x2,y2)`  
  - `GetRegionsInAreaRequest`: прямоугольная область `(x1,y1,x2,y2)`  
- **Ответы:**
  - `GetObjectsInAreaResponse`: список объектов с ID, координатами и размерами  
  - `GetRegionsInAreaResponse`: список регионов с ID и метаданными  
- **События (уведомления):**
  - `ObjectAdded`
  - `ObjectUpdated`
  - `ObjectDeleted`  
  Каждое событие содержит ID объекта, координаты, размеры и другую необходимую информацию.  

> Все контракты должны быть сериализуемы через MemoryPack.  

---

## Обратить внимание на следующие аспекты
- **Производительность.** Запросы к карте должны быть быстрыми; работа сетевого слоя не должна блокировать основной поток сервера.  
- **Асинхронность и потокобезопасность.** LiteNetLib работает в неблокирующем режиме, поэтому доступ к слоям карты должен быть потокобезопасным через интерфейсы.  
- **Согласованность.** Сообщения о добавлении, изменении и удалении объектов должны отражать актуальное состояние карты.  
- **Расширяемость.** Сетевой слой должен быть готов к добавлению новых типов запросов и уведомлений без существенных изменений архитектуры.  
- **Минимизация данных.** Использование MemoryPack позволяет отправлять данные в бинарном формате с минимальной нагрузкой.  

---

## Критерии приёмки
- UDP сервер на LiteNetLib корректно принимает запросы клиентов и отвечает с актуальными данными о объектах и регионах в указанной области.  
- События `ObjectAdded`, `ObjectUpdated`, `ObjectDeleted` корректно рассылаются всем подключённым клиентам при изменении данных через интерфейсы слоёв.  
- Все контракты сериализуются/десериализуются через MemoryPack без ошибок.  
- Запросы и уведомления обрабатываются корректно в многопоточной среде.  
- Модуль покрыт unit-тестами для всех основных операций, включая пограничные случаи (пустая область, объекты на границе, одновременные обновления).  
